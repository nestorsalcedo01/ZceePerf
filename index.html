<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>An√°lisis de Rendimiento de z/OS Connect: CP vs. zIIP</title>
    <style>
        :root {
            --primary-color: #00539f; /* Un azul IBM m√°s profundo */
            --secondary-color: #0f62fe; /* Un azul m√°s brillante para acentos */
            --bg-color: #f4f4f4;
            --card-bg-color: #ffffff;
            --text-color: #161616;
            --heading-color: #003a70;
            --border-color: #e0e0e0;
            --header-bg: linear-gradient(135deg, #003a70 0%, #00539f 100%);
        }

        body {
            font-family: 'IBM Plex Sans', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            line-height: 1.6;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 30px;
        }

        header {
            grid-column: 1 / -1;
            background: var(--header-bg);
            color: white;
            padding: 3rem 2rem;
            text-align: center;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        header h1 {
            margin: 0;
            font-size: 2.8rem;
            font-weight: 600;
        }

        header p {
            font-size: 1.3rem;
            opacity: 0.9;
            margin-top: 10px;
            font-weight: 300;
        }

        /* Barra de Navegaci√≥n Lateral */
        aside {
            position: sticky;
            top: 20px;
            align-self: start;
        }

        nav {
            background-color: var(--card-bg-color);
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.03);
        }

        nav h2 {
            margin-top: 0;
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 10px;
            font-size: 1.3rem;
            color: var(--heading-color);
        }

        nav ul {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }

        nav li {
            margin-bottom: 12px;
        }

        nav a {
            text-decoration: none;
            color: var(--primary-color);
            font-weight: 500;
            font-size: 0.95rem;
            transition: all 0.2s ease-in-out;
            display: block;
            padding: 5px;
            border-radius: 5px;
        }

        nav a:hover,
        nav a:focus {
            color: var(--secondary-color);
            background-color: #f0f4f8;
            text-decoration: none;
        }

        /* Contenido Principal */
        main {
            grid-column: 2 / 3;
        }

        section {
            background-color: var(--card-bg-color);
            padding: 2.5rem;
            margin-bottom: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            scroll-margin-top: 20px; /* Para el anclaje */
        }

        h2, h3, h4 {
            color: var(--heading-color);
            font-weight: 600;
            margin-top: 1.5rem;
        }

        h2 {
            font-size: 2.2rem;
            border-bottom: 3px solid var(--primary-color);
            padding-bottom: 10px;
            margin-bottom: 1.5rem;
        }

        h3 {
            font-size: 1.7rem;
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 8px;
            margin-bottom: 1.2rem;
        }

        h4 {
            font-size: 1.3rem;
            color: var(--secondary-color);
            border: none;
            margin-bottom: 1rem;
        }

        p, li {
            font-size: 1.05rem;
            margin-bottom: 1rem;
        }

        code {
            font-family: 'IBM Plex Mono', Consolas, "Liberation Mono", Menlo, Courier, monospace;
            background-color: #eef1f5;
            padding: 3px 7px;
            border-radius: 6px;
            font-size: 0.95em;
            color: #393939;
            border: 1px solid #dce1e5;
        }

        blockquote {
            border-left: 5px solid var(--secondary-color);
            background-color: #f0f4f8;
            padding: 15px 25px;
            margin: 25px 0;
            font-size: 1.1em;
            font-style: italic;
            border-radius: 0 8px 8px 0;
        }
        
        blockquote strong {
            font-style: normal;
            font-weight: 600;
            color: var(--heading-color);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 25px 0;
            font-size: 0.95em;
            box-shadow: 0 2px 6px rgba(0,0,0,0.05);
            border-radius: 8px;
            overflow: hidden;
        }

        th, td {
            border: 1px solid var(--border-color);
            padding: 14px 16px;
            text-align: left;
        }

        th {
            background-color: #f0f4f8;
            font-weight: 600;
            color: var(--heading-color);
            font-size: 1rem;
        }

        tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        tr:hover {
            background-color: #f5f8fc;
        }

        /* --- INICIO DE ESTILOS DE SECCI√ìN 7 MEJORADA --- */
        .checklist-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 2rem;
        }

        .checklist-category-card {
            background-color: #f9fbfd;
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 1.5rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.03);
            transition: all 0.2s ease-in-out;
        }

        .checklist-category-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.07);
        }

        .checklist-category-card h3 {
            font-size: 1.3rem;
            color: var(--heading-color);
            margin-top: 0;
            margin-bottom: 1rem;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--secondary-color);
            display: flex;
            align-items: center;
        }
        
        .checklist-category-card h3 .icon {
            font-size: 1.5rem;
            margin-right: 10px;
        }

        /* Ajustes a la lista de verificaci√≥n dentro de las tarjetas */
        .checklist {
            list-style-type: none;
            padding-left: 0;
        }
        
        .checklist li {
            font-size: 0.95rem; /* Un poco m√°s peque√±o para caber bien */
            margin-bottom: 12px;
            display: flex;
            align-items: flex-start; /* Alinear con el inicio del texto */
            line-height: 1.4;
        }
        
        .checklist label {
            display: flex;
            align-items: flex-start;
            cursor: pointer;
        }

        .checklist input[type="checkbox"] {
            /* Ocultar checkbox por defecto */
            opacity: 0;
            width: 0;
            height: 0;
        }

        /* Crear un checkbox personalizado */
        .checklist label::before {
            content: '';
            width: 18px; /* Un poco m√°s peque√±o */
            height: 18px;
            border: 2px solid var(--secondary-color);
            border-radius: 4px;
            margin-right: 12px;
            flex-shrink: 0; /* Evitar que se encoja */
            margin-top: 2px; /* Alinear con el texto */
            transition: all 0.2s;
        }
        /* --- FIN DE ESTILOS DE SECCI√ìN 7 MEJORADA --- */


        footer {
            grid-column: 1 / -1;
            text-align: center;
            margin-top: 20px;
            padding: 2rem;
            font-size: 0.95em;
            color: #555;
            border-top: 1px solid var(--border-color);
        }

        /* Responsive Design */
        @media (max-width: 900px) {
            .container {
                grid-template-columns: 1fr;
            }
            aside {
                position: static;
                grid-row: 2;
                margin-top: -10px;
                margin-bottom: 20px;
            }
            main {
                grid-row: 3;
            }
            header {
                padding: 2rem 1.5rem;
            }
            header h1 {
                font-size: 2.2rem;
            }
            header p {
                font-size: 1.1rem;
            }
            section {
                padding: 1.5rem;
            }
            h2 {
                font-size: 1.8rem;
            }
            h3 {
                font-size: 1.5rem;
            }
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@300;400;500;600&family=IBM+Plex+Mono&display=swap" rel="stylesheet">
</head>
<body>

    <header>
        <h1>Gu√≠a Completa de Rendimiento de z/OS Connect</h1>
        <p>Optimizando la Din√°mica de Procesadores CP y zIIP para Cargas de Trabajo de API Provider y Requester</p>
    </header>

    <div class="container">
        <aside>
            <nav>
                <h2>Navegaci√≥n R√°pida</h2>
                <ul>
                    <li><a href="#section-1">1. Arquitectura CPU (CP vs. zIIP)</a></li>
                    <li><a href="#section-2">2. Anatom√≠a de la Carga de Trabajo</a></li>
                    <li><a href="#section-3">3. Impacto de Escasez de CPU</a></li>
                    <li><a href="#section-4">4. Marco de Medici√≥n y An√°lisis</a></li>
                    <li><a href="#section-5">5. Estrategias de Optimizaci√≥n</a></li>
                    <li><a href="#section-6">6. Conclusi√≥n y Hallazgos</a></li>
                    <li><a href="#section-7">7. Lista de Verificaci√≥n</a></li>
                </ul>
            </nav>
        </aside>

        <main>
            <section id="section-1">
                <h2>Secci√≥n 1: Arquitectura Fundamental de CPU (CP vs. zIIP)</h2>
                <p>El entorno de procesamiento en los mainframes IBM Z se basa en una distinci√≥n cr√≠tica entre dos tipos de procesadores. Comprender su interacci√≥n es fundamental para la econom√≠a y el rendimiento de z/OS Connect.</p>

                <h3>Procesadores de Prop√≥sito General (CPs)</h3>
                <p>Los CPs (o GCPs) son los motores de procesamiento primarios del mainframe. Son responsables de ejecutar el n√∫cleo del sistema operativo z/OS, la l√≥gica de aplicaciones tradicionales (como CICS, IMS, Db2) y la gesti√≥n de todas las operaciones de entrada/salida (I/O). El uso de CP est√° directamente vinculado a la clasificaci√≥n de Millones de Unidades de Servicio (MSU) de la m√°quina, que es la base principal para los costos de licencia de software de Cargo de Licencia Mensual (MLC) tanto de IBM como de proveedores independientes (ISV). Por lo tanto, gestionar su utilizaci√≥n es un objetivo clave para la optimizaci√≥n de costos.</p>

                <h3>Procesadores de Informaci√≥n Integrada z (zIIPs)</h3>
                <p>Los zIIPs son motores de especialidad dise√±ados para procesar tipos de trabajo espec√≠ficos y "nuevos", como Java y APIs RESTful, de forma as√≠ncrona a los CPs. Su propuesta de valor es principalmente econ√≥mica: el trabajo ejecutado en un zIIP generalmente no contribuye a los cargos de software basados en MSU. Esto permite a las organizaciones modernizar sus aplicaciones sin impactar significativamente sus costos de licenciamiento.</p>
                <p>Una diferencia operativa clave es la velocidad. Los zIIPs siempre operan a la velocidad m√°xima del modelo de procesador, mientras que los CPs en modelos de subcapacidad son ralentizados deliberadamente. Esta disparidad es relevante cuando el trabajo destinado a un zIIP debe desbordarse hacia un CP.</p>

                <h3>El Modelo de Despacho CP-zIIP</h3>
                <p>El trabajo elegible para zIIP no se origina de forma aut√≥noma en el zIIP. Primero debe ser reconocido y despachado por un CP. Un CP siempre est√° involucrado en la iniciaci√≥n de la unidad de trabajo, que luego se transfiere a un zIIP disponible para su ejecuci√≥n. Esta dependencia inicial significa que la disponibilidad y capacidad de respuesta de los CPs son un prerrequisito para la utilizaci√≥n eficiente de los zIIPs. El despachador de z/OS, junto con el Workload Manager (WLM), determina si la unidad de trabajo (t√©cnicamente, un Bloque de Solicitud de Servicio o SRB) es elegible para ser descargada.</p>
            </section>

            <section id="section-2">
                <h2>Secci√≥n 2: Anatom√≠a de la Carga de Trabajo de z/OS Connect</h2>
                <p>z/OS Connect est√° construido sobre el perfil WebSphere Liberty y escrito predominantemente en Java. Esta base tecnol√≥gica es la clave de su perfil de rendimiento, ya que la ejecuci√≥n de Java en z/OS es altamente elegible para la descarga a zIIP. IBM declara que m√°s del 99% del c√≥digo del producto z/OS Connect es elegible para ser descargado a procesadores zIIP.</p>
                <p>Sin embargo, una transacci√≥n de API de extremo a extremo no es monol√≠tica. Es una secuencia de tareas distintas, algunas vinculadas a CP y otras elegibles para zIIP.</p>

                <h3>Anatom√≠a de un Flujo de API Provider (Entrante)</h3>
                <p>Este es el ciclo de vida de una solicitud de API que *entra* a z/OS para acceder a un sistema de registro (SoR) como CICS o IMS.</p>
                <ol>
                    <li><strong>Llegada y Despacho Inicial (CP-Bound):</strong> Cada solicitud entrante es manejada inicialmente por un CP, que gestiona la pila de red y prepara el trabajo para la JVM.</li>
                    <li><strong>Evaluaci√≥n de Elegibilidad (CP-Bound):</strong> El despachador de z/OS y WLM determinan si el trabajo puede moverse a un zIIP.</li>
                    <li><strong>Procesamiento Principal (zIIP-Eligible):</strong> Si un zIIP est√° disponible, el trabajo se despacha all√≠. Esta es la parte m√°s intensiva en CPU de z/OS Connect e incluye:
                        <ul>
                            <li><strong>Transformaci√≥n de Datos JSON:</strong> El an√°lisis (parsing) de payloads JSON entrantes y la generaci√≥n de JSON saliente es totalmente elegible para zIIP.</li>
                            <li><strong>Seguridad y Criptograf√≠a:</strong> El cifrado/descifrado de red (IPsec) puede ser descargado a zIIPs.</li>
                        </ul>
                    </li>
                    <li><strong>Llamada al Sistema de Registro (SoR) (CP-Bound):</strong> La llamada final al backend (CICS, IMS, Db2) se ejecuta predominantemente en CPs.</li>
                </ol>
                <blockquote>
                    <strong>Punto Cr√≠tico:</strong> El costo total de CPU de una llamada API es la suma de (CPU de z/OS Connect) + (CPU del SoR). Mientras que el primer t√©rmino es altamente elegible para zIIP, el segundo no lo es. No comprender esto puede llevar a un aprovisionamiento insuficiente de CPs.
                </blockquote>

                <h3>Anatom√≠a de un Flujo de API Requester (Saliente)</h3>
                <p>Este es el flujo cuando una aplicaci√≥n z/OS (como CICS o un trabajo batch) llama a z/OS Connect para consumir una API RESTful externa.</p>
                <ol>
                    <li><strong>Llamada de Aplicaci√≥n a z/OS Connect (CP-Bound):</strong> La comunicaci√≥n inicial (ej. WOLA, IPIC) desde la aplicaci√≥n z/OS a z/OS Connect est√° vinculada a CPs.</li>
                    <li><strong>Procesamiento Pre-Llamada (Mixto):</strong>
                        <ul>
                            <li><strong>Seguridad (CP-Bound):</strong> La validaci√≥n de la identidad (ej. SAF) es intensiva en CP, aunque puede mitigarse con perfiles RACLISTed.</li>
                            <li><strong>Transformaci√≥n de Datos (zIIP-Eligible):</strong> Convertir la estructura de datos de COBOL a un payload JSON (marshalling) es una actividad central de Java y altamente elegible para zIIP.</li>
                        </ul>
                    </li>
                    <li><strong>E/S de Red Saliente (CP-Bound):</strong> El establecimiento del socket, el handshake TLS y el env√≠o de la solicitud HTTP son funciones del sistema operativo vinculadas a CPs.</li>
                    <li><strong>Espera de Respuesta:</strong> El hilo espera, consumiendo m√≠nima CPU.</li>
                    <li><strong>Procesamiento Post-Llamada (Mixto):</strong>
                        <ul>
                            <li><strong>Recepci√≥n de Red (CP-Bound):</strong> Recibir la respuesta HTTP est√° vinculado a CPs.</li>
                            <li><strong>Transformaci√≥n de Datos (zIIP-Eligible):</strong> Analizar el JSON de respuesta y transformarlo de nuevo a COBOL (unmarshalling) es highly elegible para zIIP.</li>
                        </ul>
                    </li>
                    <li><strong>Retorno a la Aplicaci√≥n (CP-Bound):</strong> Devolver los datos a la aplicaci√≥n z/OS llamante est√° vinculado a CPs.</li>
                </ol>
                <blockquote>
                    <strong>Punto Cr√≠tico:</strong> El rendimiento de una llamada de API Requester es una secuencia de tareas. Un cuello de botella en las fases vinculadas a CP (como la E/S de red o la seguridad) puede dominar el tiempo de respuesta total, incluso si la utilizaci√≥n de zIIP es baja.
                </blockquote>
            </section>

            <section id="section-3">
                <h2>Secci√≥n 3: El Impacto de la Escasez de Procesadores</h2>
                <p>La contenci√≥n de procesadores ocurre cuando la demanda de ciclos de CP o zIIP excede la oferta disponible. Esto no es un problema aislado; desencadena una cascada de efectos que degradan el rendimiento.</p>

                <h3>Definici√≥n de Contenci√≥n y Retardo de CP</h3>
                <p>WLM gestiona la contenci√≥n priorizando el trabajo. Cuando una unidad de trabajo est√° lista para ejecutarse pero no hay un CP disponible, incurre en <strong>"Retardo de CPU" (CPU Delay)</strong>. Esta es una m√©trica clave capturada por RMF y es el porcentaje de tiempo que un trabajo estuvo listo pero en cola, esperando un procesador. El Retardo de CP se traduce directamente en tiempos de respuesta aumentados e impredecibles, rendimiento reducido e inestabilidad del sistema.</p>

                <h3>Escenario 1: Saturaci√≥n de zIIP y el Efecto "Spillover" (Desbordamiento)</h3>
                <p>Los zIIPs son un recurso finito. Cuando todos los zIIPs disponibles est√°n ocupados (debido a altos vol√∫menes, JSON grandes o cargas de trabajo concurrentes), el sistema redirige el trabajo elegible para zIIP para que se ejecute en los CPs de prop√≥sito general. Este "desbordamiento" (spillover) tiene graves consecuencias:</p>
                <ul>
                    <li><strong>Aumento de Costos de Software:</strong> El trabajo que estaba destinado a ser "gratuito" (desde la perspectiva de licenciamiento) ahora se ejecuta en CPs facturables, consumiendo MSUs y aumentando los costos de MLC.</li>
                    <li><strong>Aumento de la Contenci√≥n de CP:</strong> Este trabajo de desbordamiento ahora compite directamente con el trabajo cr√≠tico que *debe* ejecutarse en CPs (como CICS, Db2 y la E/S de red).</li>
                    <li><strong>DegradACI√ìN del Rendimiento:</strong> El trabajo desbordado perjudica activamente el rendimiento de toda la LPAR. Ralentiza el SoR de backend, lo que a su vez retiene la solicitud de z/OS Connect por m√°s tiempo, exacerbando el problema en un ciclo de retroalimentaci√≥n de degradaci√≥n.</li>
                </ul>

                <h3>Escenario 2: Escasez de CP y el Efecto "Bottleneck" (Cuello de Botella)</h3>
                <p>Un entorno con restricciones de CP es aquel en el que la demanda total de ciclos de CP (trabajo de SoR, E/S, gesti√≥n del sistema operativo y trabajo desbordado de zIIP) excede la capacidad. Esto paraliza a z/OS Connect de varias maneras:</p>
                <ul>
                    <li><strong>Retraso en el Manejo Inicial:</strong> El primer paso de recibir una solicitud de la red se retrasa, ya que requiere un CP.</li>
                    <li><strong>Llamadas al SoR/Red Congeladas:</strong> Todas las llamadas salientes (al SoR en flujos de Provider, a la red en flujos de Requester) deben despacharse en un CP. La escasez significa esperas m√°s largas para estas partes cr√≠ticas.</li>
                    <li><strong>Gesti√≥n de JVM Degradada:</strong> La Recolecci√≥n de Basura (Garbage Collection - GC) puede tener componentes que requieren ciclos de CP. Los retrasos aqu√≠ provocan pausas en la aplicaci√≥n.</li>
                </ul>

                <h3>Sintomatolog√≠a y el Ciclo de Retroalimentaci√≥n</h3>
                <p>La escasez de CP crea un ciclo de retroalimentaci√≥n perjudicial, especialmente para los flujos de API Requester:</p>
                <ol>
                    <li>El <strong>Retardo de CP</strong> ralentiza las tareas vinculadas a CP (ej. E/S de red).</li>
                    <li>Esto aumenta la duraci√≥n total de la solicitud, lo que significa que las hebras (threads) de Liberty se retienen por m√°s tiempo.</li>
                    <li>Una mayor ocupaci√≥n de hebras aumenta la concurrencia y la probabilidad de <strong>saturaci√≥n de zIIP</strong> (m√°s transformaciones JSON activas).</li>
                    <li>La saturaci√≥n de zIIP causa <strong>desbordamiento (spillover)</strong> a los CPs.</li>
                    <li>Este desbordamiento <strong>aumenta a√∫n m√°s la contenci√≥n de CP</strong>, regresando al paso 1 con un retardo a√∫n peor.</li>
                </ol>
                <p>Este ciclo puede llevar a una r√°pida degradaci√≥n del servicio, agotamiento de la agrupaci√≥n de hebras y fallos en cascada. Un valor de desbordamiento alto no es solo un problema de costos; es un indicador cr√≠tico en tiempo real de la degradaci√≥n del rendimiento sist√©mico.</p>
            </section>

            <section id="section-4">
                <h2>Secci√≥n 4: Marco de Medici√≥n y An√°lisis</h2>
                <p>Para diagnosticar estos problemas, es indispensable un enfoque de monitoreo de m√∫ltiples capas, correlacionando datos del sistema (RMF) con datos de la aplicaci√≥n (SMF 123).</p>

                <h3>Capa 1: An√°lisis a Nivel de LPAR (RMF/SMF Tipo 70)</h3>
                <p>Este informe proporciona una visi√≥n de alto nivel de la salud general de los procesadores de la LPAR.</p>
                <ul>
                    <li><strong>Informe Clave:</strong> Informe de Actividad de CPU de RMF (SMF Tipo 70, Subtipo 1).</li>
                    <li><strong>M√©tricas a Analizar:</strong>
                        <ul>
                            <li><code>LPAR Busy</code> vs. <code>MVS Busy</code>: Si LPAR Busy es significativamente mayor, indica contenci√≥n a nivel de CEC (demanda latente).</li>
                            <li><strong>Ocupaci√≥n de CP y zIIP del LPAR:</strong> Buscar intervalos donde la ocupaci√≥n de CP sea consistentemente alta (>95%) y la ocupaci√≥n de zIIP tambi√©n sea alta. Esta combinaci√≥n predice el desbordamiento.</li>
                            <li><strong>Vista de HiperDispatch:</strong> Verificar si hay procesadores "Aparcados" (Parked). Si no hay procesadores aparcados durante picos, indica alta utilizaci√≥n.</li>
                        </ul>
                    </li>
                </ul>

                <h3>Capa 2: An√°lisis Granular de Carga de Trabajo (RMF/SMF Tipo 72)</h3>
                <p>Este es el informe m√°s cr√≠tico para entender la efectividad de la descarga a zIIP y medir la contenci√≥n a nivel de la clase de servicio de z/OS Connect.</p>
                <ul>
                    <li><strong>Informe Clave:</strong> Informe de Actividad de la Carga de Trabajo de RMF (WLMGL) (SMF Tipo 72, Subtipo 3).</li>
                    <li><strong>M√©tricas Clave a Analizar:</strong>
                        <table>
                            <thead>
                                <tr>
                                    <th>M√©trica</th>
                                    <th>Campo SMF 72-3</th>
                                    <th>Descripci√≥n</th>
                                    <th>Qu√© Buscar (Interpretaci√≥n)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><code>APPL% -> CP</code></td>
                                    <td>-</td>
                                    <td>Porcentaje de tiempo de CPU que se ejecut√≥ en un CP est√°ndar.</td>
                                    <td>Indica trabajo no elegible o desbordado.</td>
                                </tr>
                                <tr>
                                    <td><code>APPL% -> IIP</code></td>
                                    <td>-</td>
                                    <td>Porcentaje de tiempo de CPU que se ejecut√≥ con √©xito en un zIIP.</td>
                                    <td>Mide la descarga exitosa. Un valor alto es deseable.</td>
                                </tr>
                                <tr>
                                    <td><strong><code>APPL% -> IIPCP</code></strong></td>
                                    <td><code>R723SUCU</code></td>
                                    <td>Porcentaje de tiempo de CPU que era <strong>elegible para zIIP</strong> pero se vio forzado a ejecutarse en un CP est√°ndar debido a que los zIIPs estaban ocupados.</td>
                                    <td><strong>La m√©trica m√°s importante para la saturaci√≥n de zIIP.</strong> Un valor creciente es un indicador principal de un cuello de botella de zIIP.</td>
                                </tr>
                                 <tr>
                                    <td><strong><code>CPU DLY %</code></strong></td>
                                    <td><code>R723CADL</code></td>
                                    <td>Porcentaje de tiempo que la carga de trabajo estuvo lista para ejecutarse pero estaba esperando un CP.</td>
                                    <td><strong>La medida directa del retardo de CP.</strong> Causa ra√≠z del aumento del tiempo de respuesta.</td>
                                </tr>
                                <tr>
                                    <td><code>VELOCITY</code></td>
                                    <td>-</td>
                                    <td>Indicador de si la carga de trabajo est√° cumpliendo sus objetivos de WLM.</td>
                                    <td>Una velocidad por debajo del objetivo indica que la carga de trabajo est√° siendo retrasada.</td>
                                </tr>
                            </tbody>
                        </table>
                    </li>
                </ul>

                <h3>Capa 3: Diagn√≥stico en Tiempo Real (RMF III / OMEGAMON)</h3>
                <p>Estas herramientas son cruciales para diagnosticar problemas activos e identificar los trabajos espec√≠ficos que causan contenci√≥n.</p>
                <ul>
                    <li><strong>RMF Monitor III:</strong>
                        <ul>
                            <li><strong>Informe de Retrasos de Trabajos (Job Delays):</strong> Muestra qu√© espacios de direcciones est√°n siendo retrasados. Un valor alto en la columna <code>PRC</code> para z/OS Connect indica que est√° esperando un procesador.</li>
                            <li><strong>Informe de Retrasos del Procesador (Processor Delays):</strong> Desglosa el retraso <code>PRC</code>. Un <code>DELAY%</code> alto para zIIPs significa saturaci√≥n de zIIP. Un <code>DELAY%</code> alto para CPs significa contenci√≥n de CP.</li>
                        </ul>
                    </li>
                    <li><strong>OMEGAMON for JVM (o similar):</strong>
                        <ul>
                            <li><strong>Uso de CPU de JVM:</strong> Muestra el desglose en tiempo real entre tiempo de CP, tiempo de zIIP y, crucialmente, el trabajo elegible para zIIP que se ejecuta en CPs (el equivalente en tiempo real de <code>IIPCP</code>).</li>
                            <li><strong>Detalles de Hebras (Threads):</strong> Permite identificar hebras bloqueadas o de larga duraci√≥n.</li>
                            <li><strong>Alertas (Situaciones):</strong> Se deben configurar alertas proactivas.
                                <ul>
                                    <li><strong>Advertencia:</strong> <code>% zIIP en CP</code> > 10% sostenido.</li>
                                    <li><strong>Cr√≠tico:</strong> <code>% zIIP en CP</code> > 50% (indica contenci√≥n severa).</li>
                                    <li><strong>Cr√≠tico:</strong> Tiempo de Respuesta Promedio > 2x la l√≠nea base.</li>
                                    <li><strong>Advertencia:</strong> Recuento de Hebras Activas > 80% del m√°ximo (riesgo de agotamiento).</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>

                <h3>Capa 4: An√°lisis de Solicitudes de Extremo a Extremo (SMF Tipo 123)</h3>
                <p>Este registro es generado por el propio z/OS Connect y es la fuente definitiva para el tiempo de respuesta de las solicitudes individuales. Es crucial habilitar los registros V2 (<code>apiRequesterSmfVersion="2"</code>) para flujos de Requester, ya que contienen marcas de tiempo m√°s detalladas.</p>
                <ul>
                    <li><strong>Metodolog√≠a de Correlaci√≥n:</strong>
                        <ol>
                            <li>Identificar per√≠odos de alto Retardo de CP (<code>CPU DLY %</code>) o alto desbordamiento (<code>IIPCP %</code>) usando RMF (SMF 72).</li>
                            <li>Extraer los registros SMF 123 para el mismo intervalo de tiempo.</li>
                            <li>Calcular los componentes del tiempo de respuesta usando las marcas de tiempo de SMF 123.</li>
                        </ol>
                    </li>
                    <li><strong>C√°lculo de Tiempos (Ejemplo API Provider):</strong>
                        <table>
                            <thead>
                                <tr>
                                    <th>Marca de Tiempo (V2)</th>
                                    <th>Descripci√≥n</th>
                                    <th>F√≥rmula</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><code>TIME_ZC_ENTRY</code></td>
                                    <td>Llegada de la solicitud a z/OS Connect.</td>
                                    <td rowspan="4" style="vertical-align: middle;">
                                        <strong>Tiempo en SoR</strong> = <code>TIME_SOR_RECV</code> - <code>TIME_SOR_SENT</code><br><br>
                                        <strong>Tiempo total en z/OS Connect</strong> = <code>TIME_ZC_EXIT</code> - <code>TIME_ZC_ENTRY</code><br><br>
                                        <strong>Tiempo de procesamiento en z/OS Connect</strong> = (Tiempo total) - (Tiempo en SoR)
                                    </td>
                                </tr>
                                <tr>
                                    <td><code>TIME_SOR_SENT</code></td>
                                    <td>Solicitud enviada al SoR.</td>
                                </tr>
                                <tr>
                                    <td><code>TIME_SOR_RECV</code></td>
                                    <td>Respuesta recibida del SoR.</td>
                                </tr>
                                <tr>
                                    <td><code>TIME_ZC_EXIT</code></td>
                                    <td>Respuesta enviada al cliente.</td>
                                </tr>
                            </tbody>
                        </table>
                    </li>
                    <li><strong>Conclusi√≥n de la Correlaci√≥n:</strong> Si el <strong>"Tiempo de procesamiento en z/OS Connect"</strong> (o "Tiempo en z/OS Connect" para flujos de Requester) est√° elevado durante per√≠odos de alto <code>CPU DLY %</code> o <code>IIPCP %</code>, se demuestra que la contenci√≥n de CPU es la causa ra√≠z de la degradaci√≥n del rendimiento.</li>
                </ul>
            </section>

            <section id="section-5">
                <h2>Secci√≥n 5: Estrategias Proactivas de Ajuste y Optimizaci√≥n</h2>
                <p>El diagn√≥stico debe ir seguido de acciones correctivas. Estas estrategias ayudan a prevenir la contenci√≥n y asegurar un rendimiento √≥ptimo.</p>

                <h3>1. Configuraci√≥n Estrat√©gica de WLM</h3>
                <p>Una configuraci√≥n adecuada de WLM es la primera l√≠nea de defensa. No se debe usar un objetivo discrecional para z/OS Connect.</p>
                <ul>
                    <li><strong>Clasificaci√≥n:</strong> Es fundamental habilitar <code>zosWlm-1.0</code> en <code>server.xml</code> y usar reglas de <code>httpClassification</code> para asignar la STC del servidor y los enclaves de solicitud (tipo CB) a clases de servicio separadas y de m√∫ltiples per√≠odos.</li>
                    <li><strong>Objetivos de M√∫ltiples Per√≠odos:</strong> Para las solicitudes (enclaves CB), el primer per√≠odo debe tener un objetivo de velocidad alto (ej. Velocity 80%) con una duraci√≥n corta. Esto prioriza las solicitudes r√°pidas. Las solicitudes de larga duraci√≥n caen a per√≠odos posteriores con menor prioridad, protegiendo al sistema.</li>
                    <li><strong>Niveles de Importancia (Flujo Provider):</strong> Para un proveedor de API, el SoR de backend (ej. CICS) debe tener una importancia <strong>m√°s alta</strong> que el servidor z/OS Connect. Esto act√∫a como un estrangulamiento natural, evitando que z/OS Connect inunde un backend con dificultades y protegiendo al componente m√°s vulnerable.</li>
                    <li><strong>Niveles de Importancia (Flujo Requester):</strong> Para un solicitante de API, el servidor z/OS Connect debe tener una importancia <strong>m√°s alta</strong> que la aplicaci√≥n que lo llama (ej. un trabajo batch).</li>
                    <li><strong>Par√°metro <code>IIPHONORPRIORITY</code>:</strong> Este par√°metro de LPAR (predeterminado YES) permite que el trabajo de zIIP desbordado compita por CPs seg√∫n su prioridad de WLM. En entornos con escasez severa de CP, cambiarlo a NO (forzando al trabajo a esperar un zIIP) podr√≠a ser una opci√≥n de ajuste avanzada para preservar los CPs, aunque puede aumentar la latencia.</li>
                </ul>

                <h3>2. Ajuste del Subsistema z/OS y TCP/IP (Enfoque Requester)</h3>
                <p>Dado que los flujos de solicitante son intensivos en red, optimizar TCP/IP puede reducir significativamente el consumo de CP y la latencia.</p>
                <ul>
                    <li><strong>Habilitar AsyncIO:</strong> Habilitar el servicio nativo de z/OS AsyncIO permite a Liberty un manejo de sockets m√°s eficiente, mejorando el rendimiento y la escalabilidad de las llamadas salientes.</li>
                    <li><strong>Ajuste del Perfil de TCP/IP:</strong>
                        <ul>
                            <li><code>TCPCONFIG DELAYACKS</code>: Habilitar acuses de recibo retardados puede reducir la cantidad de paquetes y el consumo de CPU.</li>
                            <li><strong>Checksum Offload:</strong> Descargar los c√°lculos de suma de comprobaci√≥n a las tarjetas de red OSA-Express reduce la carga en los CPs.</li>
                            <li><strong>Tama√±os de B√∫fer:</strong> Asegurar tama√±os adecuados (ej. >= 64KB) para <code>DefaultSendBufferSize</code> y <code>DefaultReceiveBufferSize</code> optimiza el rendimiento de la red.</li>
                        </ul>
                    </li>
                </ul>

                <h3>3. Optimizaci√≥n a Nivel de Aplicaci√≥n (Reducci√≥n de Payloads)</h3>
                <p>Reducir la demanda de CPU en la fuente es la forma m√°s eficiente de optimizaci√≥n. El costo de CPU es directamente proporcional al tama√±o del payload JSON que debe ser transformado.</p>
                <ul>
                    <li><strong>Excluir Campos No Utilizados:</strong> Trabajar con los desarrolladores para mapear solo los campos absolutamente necesarios. Excluir campos no utilizados del mapeo del copybook reduce dr√°sticamente el tama√±o del payload y el consumo de CPU.</li>
                    <li><strong>Usar <code>OCCURS DEPENDING ON</code> (ODO):</strong> Para arrays de COBOL, usar ODO en lugar de arrays de tama√±o fijo permite payloads de tama√±o variable, reduciendo la sobrecarga de transformaci√≥n.</li>
                    <li><strong>Renombrar Campos:</strong> Usar nombres de campo m√°s cortos en el esquema JSON reduce los datos a analizar, proporcionando una ganancia marginal pero significativa para APIs de alto volumen.</li>
                </ul>

                <h3>4. Planificaci√≥n Proactiva de la Capacidad</h3>
                <p>La planificaci√≥n de capacidad es fundamental y no debe basarse en promedios, sino en vol√∫menes m√°ximos, ya que las cargas de trabajo de zIIP suelen ser "puntiagudas". El objetivo debe ser mantener el valor de <code>IIPCP</code> cerca de cero durante los picos de negocio.</p>
                <p>Las m√©tricas <code>% CPU DLY</code> y <code>% IIPCP</code> deben guiar la toma de decisiones:</p>
                <ul>
                    <li><strong><code>% CPU DLY</code> alto, <code>% IIPCP</code> bajo:</strong> Cuello de botella cl√°sico de CP. La soluci√≥n es a√±adir CPs o ajustar otras cargas de trabajo pesadas en CP.</li>
                    <li><strong><code>% CPU DLY</code> bajo, <code>% IIPCP</code> alto:</strong> Cuello de botella cl√°sico de zIIP. La soluci√≥n es a√±adir zIIPs.</li>
                    <li><strong><code>% CPU DLY</code> alto, <code>% IIPCP</code> alto:</strong> El sistema est√° completamente saturado. Este es un d√©ficit cr√≠tico de capacidad que requiere la adici√≥n de ambos, CPs y zIIPs.</li>
                    <li><strong><code>% CPU DLY</code> bajo, <code>% IIPCP</code> bajo:</strong> El problema de rendimiento no est√° relacionado con la contenci√≥n de procesadores en z/OS. La investigaci√≥n debe centrarse en la latencia de la red, el rendimiento del endpoint remoto o la l√≥gica de la aplicaci√≥n.</li>
                </ul>
                <p>Un valor de <code>% IIPCP</code> del 100% significa que un CP completo se est√° utilizando para trabajo de zIIP. Esto se puede traducir directamente en un impacto de costo de MLC, proporcionando una poderosa justificaci√≥n financiera para adquirir motores zIIP adicionales.</p>
            </section>

            <section id="section-6">
                <h2>Secci√≥n 6: Conclusi√≥n y Resumen de Hallazgos</h2>
                <p>El rendimiento de z/OS Connect est√° intr√≠nsecamente ligado a la gesti√≥n eficaz de los procesadores CP y zIIP. La arquitectura, impulsada por consideraciones econ√≥micas, ofrece un enorme potencial para procesar cargas de trabajo de modernizaci√≥n de manera rentable. Sin embargo, este modelo introduce un riesgo cr√≠tico: la saturaci√≥n de los procesadores zIIP y la contenci√≥n de los CPs.</p>
                <p>El an√°lisis ha demostrado que la carga de trabajo de z/OS Connect es una amalgama de tareas vinculadas a CP (E/S de red, seguridad) y tareas elegibles para zIIP (transformaci√≥n JSON). La escasez en cualquiera de los procesadores crea un efecto domin√≥:</p>
                <ul>
                    <li>La <strong>escasez de CP</strong> retrasa las tareas de red y seguridad, aumentando el tiempo total de la solicitud.</li>
                    <li>Esto aumenta la concurrencia, lo que lleva a la <strong>saturaci√≥n de zIIP</strong>.</li>
                    <li>La saturaci√≥n de zIIP causa un <strong>desbordamiento (spillover)</strong> de trabajo Java hacia los CPs.</li>
                    <li>Este desbordamiento <strong>exacerba la contenci√≥n de CP</strong>, degradando el rendimiento de todo el sistema y aumentando los costos de licenciamiento.</li>
                </ul>
                <p>La clave del √©xito reside en una gesti√≥n proactiva y basada en datos. Es imperativo implementar un marco de monitoreo que correlacione los datos de RMF (SMF 70 y 72) con los registros de aplicaci√≥n (SMF 123). La m√©trica <code>IIPCP</code> (o <code>% zIIP en CP</code>) emerge como el indicador principal m√°s crucial de la inminente saturaci√≥n de zIIP y la degradaci√≥n del rendimiento.</p>
            </section>

            <section id="section-7">
                <h2>Secci√≥n 7: Lista de Verificaci√≥n Accionable</h2>
                <p>Utilice esta lista de verificaci√≥n como gu√≠a estrat√©gica para la gesti√≥n proactiva del rendimiento de z/OS Connect.</p>
                
                <div class="checklist-container">
                    
                    <div class="checklist-category-card">
                        <h3><span class="icon">üîç</span> VALIDAR: Configuraci√≥n de WLM</h3>
                        <ul class="checklist">
                            <li><label><input type="checkbox"> Confirmar que <code>zosWlm-1.0</code> est√° activa en server.xml.</label></li>
                            <li><label><input type="checkbox"> Asegurar que existan reglas de <code>httpClassification</code> para las cargas de trabajo (ej. <code>/zosConnect/apiRequesters/*</code>).</label></li>
                            <li><label><input type="checkbox"> Verificar que la pol√≠tica de WLM clasifica correctamente la STC y los enclaves (CB) en clases de servicio apropiadas (usar objetivos de velocidad).</label></li>
                            <li><label><input type="checkbox"> Verificar que la importancia del SoR (CICS/IMS) es <strong>mayor</strong> que la de z/OS Connect (para flujos de Provider).</label></li>
                        </ul>
                    </div>
            
                    <div class="checklist-category-card">
                        <h3><span class="icon">üìè</span> MEDIR: Establecer L√≠neas Base</h3>
                        <ul class="checklist">
                            <li><label><input type="checkbox"> Habilitar registros SMF 123 (V2 para Requester: <code>apiRequesterSmfVersion="2"</code>).</label></li>
                            <li><label><input type="checkbox"> Recopilar y archivar regularmente datos de RMF (SMF 70, 72) y SMF 123.</label></li>
                            <li><label><input type="checkbox"> Establecer l√≠neas base para <code>Tiempo en z/OS Connect</code>, <code>% CPU DLY</code> y <code>% IIPCP</code> durante picos.</label></li>
                        </ul>
                    </div>
                    
                    <div class="checklist-category-card">
                        <h3><span class="icon">üñ•Ô∏è</span> MONITORIZAR: Alertas en Tiempo Real</h3>
                        <ul class="checklist">
                            <li><label><input type="checkbox"> Utilizar un monitor en tiempo real (RMF III, OMEGAMON for JVM).</label></li>
                            <li><label><input type="checkbox"> Alertas para <code>% zIIP en CP</code> (Advertencia > 10%, Cr√≠tico > 50%).</label></li>
                            <li><label><input type="checkbox"> Alertas para Tiempo de Respuesta (Cr√≠tico > 2x la l√≠nea base).</label></li>
                            <li><label><input type="checkbox"> Alertas para Recuento de Hebras Activas (Advertencia > 80% del m√°ximo).</label></li>
                        </ul>
                    </div>
            
                    <div class="checklist-category-card">
                        <h3><span class="icon">ü©∫</span> DIAGNOSTICAR: Analizar Anomal√≠as</h3>
                        <ul class="checklist">
                            <li><label><input type="checkbox"> Correlacionar <code>Tiempo en z/OS Connect</code> (SMF 123) con <code>% CPU DLY</code> y <code>% IIPCP</code> (RMF 72).</label></li>
                            <li><label><input type="checkbox"> Usar la "Matriz de Contenci√≥n" (Secci√≥n 5) para identificar el cuello de botella (CP, zIIP, ambos).</label></li>
                        </ul>
                    </div>
            
                    <div class="checklist-category-card">
                        <h3><span class="icon">üõ†Ô∏è</span> AJUSTAR: Optimizar el Entorno</h3>
                        <ul class="checklist">
                            <li><label><input type="checkbox"> Revisar y optimizar la pol√≠tica de WLM (ver "VALIDAR").</label></li>
                            <li><label><input type="checkbox"> (Para Requester) Habilitar <code>AsyncIO</code> para Liberty.</label></li>
                            <li><label><input type="checkbox"> (Para Requester) Revisar par√°metros de TCP/IP (<code>DELAYACKS</code>, B√∫feres).</label></li>
                            <li><label><input type="checkbox"> (Para Provider) Optimizar payloads de API (excluir campos, usar ODO).</label></li>
                        </ul>
                    </div>
            
                    <div class="checklist-category-card">
                        <h3><span class="icon">üìà</span> PLANIFICAR: Impulsar la Capacidad</h3>
                        <ul class="checklist">
                            <li><label><input type="checkbox"> Usar tendencias hist√≥ricas de <code>% IIPCP</code> para pronosticar necesidades de zIIP.</label></li>
                            <li><label><input type="checkbox"> Usar tendencias de <code>% CPU DLY</code> para evaluar la capacidad de CP.</label></li>
                            <li><label><input type="checkbox"> Traducir <code>% IIPCP</code> en impacto de costo de MLC para justificar la adquisici√≥n de hardware.</label></li>
                        </ul>
                    </div>
            
                </div>
            </section>
            </main>
    </div>

    <footer>
        <p>Este documento es una s√≠ntesis de los materiales proporcionados sobre el rendimiento de z/OS Connect. El contenido se basa en la informaci√≥n de los documentos originales.</p>
    </footer>

</body>
</html>
