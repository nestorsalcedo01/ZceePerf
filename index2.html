<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Análisis de Rendimiento de z/OS Connect: CP vs. zIIP</title>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@300;400;500;600&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-color: #00539f;
            --secondary-color: #0f62fe;
            --bg-color: #f8f8f8; /* Fondo más claro */
            --card-bg-color: #ffffff;
            --text-color: #161616;
            --heading-color: #003a70;
            --border-color: #e0e0e0;
            --header-bg: linear-gradient(135deg, #003a70 0%, #00539f 100%);
            --font-primary: 'IBM Plex Sans', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            --font-mono: 'IBM Plex Mono', Consolas, "Liberation Mono", Menlo, Courier, monospace;
        }

        /* --- Reseteo y Estilos Base --- */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: var(--font-primary);
            line-height: 1.6;
            background-color: var(--bg-color);
            color: var(--text-color);
        }

        /* --- Contenedor Principal y Layout --- */
        .container {
            max-width: 1280px;
            margin: 20px auto;
            padding: 0 20px;
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 30px;
        }

        /* --- Cabecera --- */
        header {
            grid-column: 1 / -1;
            background: var(--header-bg);
            color: white;
            padding: 3rem 2.5rem;
            text-align: center;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 83, 159, 0.2);
        }

        header h1 {
            font-size: 2.8rem;
            font-weight: 600;
        }

        header p {
            font-size: 1.3rem;
            opacity: 0.9;
            margin-top: 10px;
            font-weight: 300;
        }

        /* --- Navegación Lateral --- */
        aside {
            position: sticky;
            top: 20px;
            align-self: start;
        }

        nav {
            background-color: var(--card-bg-color);
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        nav h2 {
            margin-top: 0;
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 10px;
            font-size: 1.3rem;
            color: var(--heading-color);
            font-weight: 600;
        }

        nav ul {
            list-style-type: none;
            margin-top: 1rem;
        }

        nav li {
            margin-bottom: 8px;
        }

        nav a {
            text-decoration: none;
            color: var(--primary-color);
            font-weight: 500;
            font-size: 0.95rem;
            transition: all 0.2s ease-in-out;
            display: block;
            padding: 8px 12px;
            border-radius: 6px;
        }

        nav a:hover,
        nav a:focus {
            color: var(--secondary-color);
            background-color: #f0f4f8;
        }

        /* --- Contenido Principal --- */
        main {
            grid-column: 2 / 3;
        }

        section {
            background-color: var(--card-bg-color);
            padding: 2.5rem;
            margin-bottom: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            scroll-margin-top: 20px;
        }

        /* --- Estilos de Contenido --- */
        h2, h3, h4 {
            color: var(--heading-color);
            font-weight: 600;
            margin-top: 1.5rem;
        }

        h2 {
            font-size: 2.2rem;
            border-bottom: 3px solid var(--primary-color);
            padding-bottom: 10px;
            margin-bottom: 1.5rem;
        }

        h3 {
            font-size: 1.7rem;
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 8px;
            margin-bottom: 1.2rem;
        }

        h4 {
            font-size: 1.3rem;
            color: var(--secondary-color);
            border: none;
            margin-bottom: 1rem;
        }

        p, li {
            font-size: 1.05rem;
            margin-bottom: 1rem;
        }

        ol, ul {
            padding-left: 20px;
        }

        /* Etiqueta <code> */
        code {
            font-family: var(--font-mono);
            background-color: #eef1f5;
            padding: 3px 7px;
            border-radius: 6px;
            font-size: 0.95em;
            color: #393939;
            border: 1px solid #dce1e5;
            /* CORRECCIÓN GLOBAL: Forzar el salto de línea en código largo */
            overflow-wrap: break-word;
            word-wrap: break-word;
        }

        /* Cita en bloque */
        blockquote {
            border-left: 5px solid var(--secondary-color);
            background-color: #f0f4f8;
            padding: 15px 25px;
            margin: 25px 0;
            font-size: 1.1em;
            font-style: italic;
            border-radius: 0 8px 8px 0;
        }
        
        blockquote strong {
            font-style: normal;
            font-weight: 600;
            color: var(--heading-color);
        }

        /* Tabla */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 25px 0;
            font-size: 0.95em;
            border-radius: 8px;
            overflow: hidden; /* Para que el radius afecte a las esquinas */
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        th, td {
            border: 1px solid var(--border-color);
            padding: 14px 16px;
            text-align: left;
        }

        th {
            background-color: #f0f4f8;
            font-weight: 600;
            color: var(--heading-color);
            font-size: 1rem;
        }

        tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        tr:hover {
            background-color: #f5f8fc;
        }

        /* --- INICIO: SECCIÓN 7 CORREGIDA Y ROBUSTA --- */
        .checklist-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 2rem;
        }

        .checklist-category-card {
            background-color: #f9fbfd;
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 1.5rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.03);
            transition: all 0.2s ease-in-out;
        }

        .checklist-category-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.07);
        }

        .checklist-category-card h3 {
            font-size: 1.3rem;
            color: var(--heading-color);
            margin-top: 0;
            margin-bottom: 1rem;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--secondary-color);
            display: flex;
            align-items: center;
        }
        
        .checklist-category-card h3 .icon {
            font-size: 1.5rem;
            margin-right: 10px;
        }

        .checklist {
            list-style-type: none;
            padding-left: 0;
        }
        
        .checklist li {
            font-size: 0.95rem;
            margin-bottom: 12px;
            line-height: 1.5;
        }
        
        .checklist label {
            /* * LA CORRECCIÓN: Usar CSS Grid en la etiqueta.
             * 1ª Columna (20px): para la casilla
             * 2ª Columna (1fr): para el texto
             */
            display: grid;
            grid-template-columns: 20px 1fr; /* Columna de casilla + Columna de texto */
            gap: 12px; /* Espacio entre casilla y texto */
            align-items: start; /* Alinear arriba */
            cursor: pointer;
        }

        .checklist input[type="checkbox"] {
            /* Ocultar el checkbox real */
            display: none; 
        }

        .checklist label::before {
            /* Este es el checkbox personalizado */
            content: '';
            width: 18px;
            height: 18px;
            border: 2px solid var(--secondary-color);
            border-radius: 4px;
            transition: all 0.2s;
            margin-top: 2px; /* Alineación vertical ligera */
            /* Se ubica automáticamente en la 1ª columna del grid */
        }
        /* --- FIN: SECCIÓN 7 CORREGIDA Y ROBUSTA --- */


        /* --- Footer --- */
        footer {
            grid-column: 1 / -1;
            text-align: center;
            margin-top: 20px;
            padding: 2rem;
            font-size: 0.95em;
            color: #555;
            border-top: 1px solid var(--border-color);
        }

        /* --- Diseño Responsivo --- */
        @media (max-width: 900px) {
            .container {
                grid-template-columns: 1fr;
            }
            aside {
                position: static;
                grid-row: 2;
                margin-top: -10px;
                margin-bottom: 20px;
            }
            main {
                grid-row: 3;
            }
            header {
                padding: 2rem 1.5rem;
            }
            header h1 {
                font-size: 2.2rem;
            }
            header p {
                font-size: 1.1rem;
            }
            section {
                padding: 1.5rem;
            }
            h2 {
                font-size: 1.8rem;
            }
            h3 {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>

    <header>
        <h1>Guía Completa de Rendimiento de z/OS Connect</h1>
        <p>Optimizando la Dinámica de Procesadores CP y zIIP para Cargas de Trabajo de API Provider y Requester</p>
    </header>

    <div class="container">
        <aside>
            <nav>
                <h2>Navegación Rápida</h2>
                <ul>
                    <li><a href="#section-1">1. Arquitectura CPU (CP vs. zIIP)</a></li>
                    <li><a href="#section-2">2. Anatomía de la Carga de Trabajo</a></li>
                    <li><a href="#section-3">3. Impacto de Escasez de CPU</a></li>
                    <li><a href="#section-4">4. Marco de Medición y Análisis</a></li>
                    <li><a href="#section-5">5. Estrategias de Optimización</a></li>
                    <li><a href="#section-6">6. Conclusión y Hallazgos</a></li>
                    <li><a href="#section-7">7. Lista de Verificación</a></li>
                </ul>
            </nav>
        </aside>

        <main>
            <section id="section-1">
                <h2>Sección 1: Arquitectura Fundamental de CPU (CP vs. zIIP)</h2>
                <p>El entorno de procesamiento en los mainframes IBM Z se basa en una distinción crítica entre dos tipos de procesadores. Comprender su interacción es fundamental para la economía y el rendimiento de z/OS Connect.</p>

                <h3>Procesadores de Propósito General (CPs)</h3>
                [cite_start]<p>Los CPs (o GCPs) son los motores de procesamiento primarios del mainframe[cite: 8, 302]. [cite_start]Son responsables de ejecutar todas las funciones del sistema operativo, la lógica de las aplicaciones tradicionales (como CICS, IMS, Db2) y la gestión de todas las operaciones de entrada/salida (I/O)[cite: 9, 303]. [cite_start]El uso de CP está directamente vinculado a la clasificación de Millones de Unidades de Servicio (MSU) de la máquina, que es la base principal para los costos de licencia de software de Cargo de Licencia Mensual (MLC)[cite: 10, 303].</p>

                <h3>Procesadores de Información Integrada z (zIIPs)</h3>
                [cite_start]<p>Los zIIPs son motores de especialidad diseñados para procesar tipos de trabajo específicos y "nuevos", como Java y APIs RESTful, de forma asíncrona a los CPs[cite: 12, 304]. [cite_start]Su propuesta de valor es principalmente económica: el trabajo ejecutado en un zIIP generalmente no contribuye a los cargos de software basados en MSU[cite: 304]. [cite_start]Esto permite a las organizaciones modernizar sus aplicaciones sin impactar significativamente sus costos de licenciamiento[cite: 304].</p>
                <p>Una diferencia operativa clave es la velocidad. [cite_start]Los zIIPs siempre operan a la velocidad máxima del modelo de procesador, mientras que los CPs en modelos de subcapacidad son ralentizados deliberadamente[cite: 12, 306].</p>

                <h3>El Modelo de Despacho CP-zIIP</h3>
                [cite_start]<p>El trabajo elegible para zIIP no se origina de forma autónoma en el zIIP[cite: 15]. [cite_start]Primero debe ser reconocido y despachado por un CP[cite: 16, 309]. [cite_start]Un CP siempre está involucrado en la iniciación de la unidad de trabajo, que luego se transfiere a un zIIP disponible para su ejecución[cite: 17, 314]. [cite_start]Esta dependencia inicial significa que la disponibilidad y capacidad de respuesta de los CPs son un prerrequisito para la utilización eficiente de los zIIPs[cite: 18].</p>
            </section>

            <section id="section-2">
                <h2>Sección 2: Anatomía de la Carga de Trabajo de z/OS Connect</h2>
                [cite_start]<p>z/OS Connect está construido sobre el perfil WebSphere Liberty y escrito predominantemente en Java[cite: 20]. [cite_start]Esta base tecnológica es la clave de su perfil de rendimiento, ya que la ejecución de Java en z/OS es altamente elegible para la descarga a zIIP[cite: 21, 318]. [cite_start]IBM declara que más del 99% del código del producto z/OS Connect es elegible para ser descargado a procesadores zIIP[cite: 22, 319].</p>
                <p>Sin embargo, una transacción de API de extremo a extremo no es monolítica. [cite_start]Es una secuencia de tareas distintas, algunas vinculadas a CP y otras elegibles para zIIP[cite: 26].</p>

                <h3>Anatomía de un Flujo de API Provider (Entrante)</h3>
                <p>Este es el ciclo de vida de una solicitud de API que *entra* a z/OS para acceder a un sistema de registro (SoR) como CICS o IMS.</p>
                <ol>
                    [cite_start]<li><strong>Llegada y Despacho Inicial (CP-Bound):</strong> Cada solicitud entrante es manejada inicialmente por un CP, que gestiona la pila de red y prepara el trabajo para la JVM[cite: 309].</li>
                    [cite_start]<li><strong>Evaluación de Elegibilidad (CP-Bound):</strong> El despachador de z/OS y WLM determinan si el trabajo puede moverse a un zIIP[cite: 311].</li>
                    <li><strong>Procesamiento Principal (zIIP-Eligible):</strong> Si un zIIP está disponible, el trabajo se despacha allí. Esta es la parte más intensiva en CPU de z/OS Connect e incluye:
                        <ul>
                            [cite_start]<li><strong>Transformación de Datos JSON:</strong> El análisis (parsing) de payloads JSON entrantes y la generación de JSON saliente es totalmente elegible para zIIP[cite: 321].</li>
                            [cite_start]<li><strong>Seguridad y Criptografía:</strong> El cifrado/descifrado de red (IPsec) puede ser descargado a zIIPs[cite: 322].</li>
                        </ul>
                    </li>
                    [cite_start]<li><strong>Llamada al Sistema de Registro (SoR) (CP-Bound):</strong> La llamada final al backend (CICS, IMS, Db2) se ejecuta predominantemente en CPs[cite: 328].</li>
                </ol>
                <blockquote>
                    [cite_start]<strong>Punto Crítico:</strong> El costo total de CPU de una llamada API es la suma de (CPU de z/OS Connect) + (CPU del SoR)[cite: 325]. [cite_start]Mientras que el primer término es altamente elegible para zIIP, el segundo no lo es[cite: 326].
                </blockquote>

                <h3>Anatomía de un Flujo de API Requester (Saliente)</h3>
                [cite_start]<p>Este es el flujo cuando una aplicación z/OS (como CICS) llama a z/OS Connect para consumir una API RESTful externa[cite: 25].</p>
                <ol>
                    [cite_start]<li><strong>Llamada de Aplicación a z/OS Connect (CP-Bound):</strong> La comunicación inicial (ej. WOLA, IPIC) desde la aplicación z/OS está vinculada a CPs[cite: 28].</li>
                    <li><strong>Procesamiento Pre-Llamada (Mixto):</strong>
                        <ul>
                            [cite_start]<li><strong>Seguridad (CP-Bound):</strong> La validación de la identidad (ej. SAF) es intensiva en CP[cite: 32].</li>
                            [cite_start]<li><strong>Transformación de Datos (zIIP-Eligible):</strong> Convertir la estructura de datos de COBOL a un payload JSON (marshalling) es una actividad central de Java y altamente elegible para zIIP[cite: 34, 41].</li>
                        </ul>
                    </li>
                    [cite_start]<li><strong>E/S de Red Saliente (CP-Bound):</strong> El establecimiento del socket, el handshake TLS y el envío de la solicitud HTTP son funciones del sistema operativo vinculadas a CPs[cite: 36].</li>
                    [cite_start]<li><strong>Espera de Respuesta:</strong> El hilo espera, consumiendo mínima CPU[cite: 37].</li>
                    <li><strong>Procesamiento Post-Llamada (Mixto):</strong>
                        <ul>
                            [cite_start]<li><strong>Recepción de Red (CP-Bound):</strong> Recibir la respuesta HTTP está vinculado a CPs[cite: 39].</li>
                            [cite_start]<li><strong>Transformación de Datos (zIIP-Eligible):</strong> Analizar el JSON de respuesta y transformarlo de nuevo a COBOL (unmarshalling) es altamente elegible para zIIP[cite: 41].</li>
                        </ul>
                    </li>
                    [cite_start]<li><strong>Retorno a la Aplicación (CP-Bound):</strong> Devolver los datos a la aplicación z/OS llamante está vinculado a CPs[cite: 43].</li>
                </ol>
                <blockquote>
                    <strong>Punto Crítico:</strong> El rendimiento de una llamada de API Requester es una secuencia de tareas. [cite_start]Un cuello de botella en las fases vinculadas a CP (como la E/S de red) puede dominar el tiempo de respuesta total, incluso si la utilización de zIIP es baja[cite: 45, 46].
                </blockquote>
            </section>

            <section id="section-3">
                <h2>Sección 3: El Impacto de la Escasez de Procesadores</h2>
                [cite_start]<p>La contención de procesadores ocurre cuando la demanda de ciclos de CP o zIIP excede la oferta disponible[cite: 53]. [cite_start]Esto no es un problema aislado; desencadena una cascada de efectos que degradan el rendimiento[cite: 51].</p>

                <h3>Definición de Contención y Retardo de CP</h3>
                [cite_start]<p>WLM gestiona la contención priorizando el trabajo[cite: 54, 55]. [cite_start]Cuando una unidad de trabajo está lista para ejecutarse pero no hay un CP disponible, incurre en <strong>"Retardo de CPU" (CPU Delay)</strong>[cite: 56]. [cite_start]Esta es una métrica clave capturada por RMF y es el porcentaje de tiempo que un trabajo estuvo listo pero en cola, esperando un procesador[cite: 57, 58, 354]. [cite_start]El Retardo de CP se traduce directamente en tiempos de respuesta aumentados e impredecibles[cite: 361].</p>

                <h3>Escenario 1: Saturación de zIIP y el Efecto "Spillover" (Desbordamiento)</h3>
                [cite_start]<p>Los zIIPs son un recurso finito[cite: 71]. [cite_start]Cuando todos los zIIPs disponibles están ocupados, el sistema redirige el trabajo elegible para zIIP para que se ejecute en los CPs[cite: 72, 315]. Este "desbordamiento" (spillover) tiene graves consecuencias:</p>
                <ul>
                    [cite_start]<li><strong>Aumento de Costos de Software:</strong> El trabajo que estaba destinado a ser "gratuito" (desde la perspectiva de licenciamiento) ahora se ejecuta en CPs facturables, consumiendo MSUs y aumentando los costos de MLC[cite: 75, 76, 334].</li>
                    [cite_start]<li><strong>Aumento de la Contención de CP:</strong> Este trabajo de desbordamiento ahora compite directamente con el trabajo crítico que *debe* ejecutarse en CPs (como CICS, Db2 y la E/S de red)[cite: 73, 337].</li>
                    [cite_start]<li><strong>Degradación del Rendimiento:</strong> El trabajo desbordado perjudica activamente el rendimiento de toda la LPAR[cite: 336]. [cite_start]Ralentiza el SoR de backend, lo que a su vez retiene la solicitud de z/OS Connect por más tiempo, exacerbando el problema en un ciclo de retroalimentación[cite: 338].</li>
                </ul>

                <h3>Escenario 2: Escasez de CP y el Efecto "Bottleneck" (Cuello de Botella)</h3>
                [cite_start]<p>Un entorno con restricciones de CP es aquel en el que la demanda total de ciclos de CP excede la capacidad[cite: 340]. Esto paraliza a z/OS Connect de varias maneras:</p>
                <ul>
                    [cite_start]<li><strong>Retraso en el Manejo Inicial:</strong> El primer paso de recibir una solicitud de la red se retrasa, ya que requiere un CP[cite: 65, 342].</li>
                    [cite_start]<li><strong>Llamadas al SoR/Red Congeladas:</strong> Todas las llamadas salientes (al SoR en flujos de Provider, a la red en flujos de Requester) deben despacharse en un CP[cite: 344]. La escasez significa esperas más largas para estas partes críticas.</li>
                    [cite_start]<li><strong>Gestión de JVM Degradada:</strong> La Recolección de Basura (Garbage Collection - GC) puede tener componentes que requieren ciclos de CP[cite: 87, 346]. [cite_start]Los retrasos aquí provocan pausas en la aplicación[cite: 347].</li>
                </ul>

                <h3>Sintomatología y el Ciclo de Retroalimentación</h3>
                [cite_start]<p>La escasez de CP crea un ciclo de retroalimentación perjudicial, especialmente para los flujos de API Requester[cite: 94]:</p>
                <ol>
                    [cite_start]<li>El <strong>Retardo de CP</strong> ralentiza las tareas vinculadas a CP (ej. E/S de red)[cite: 95].</li>
                    [cite_start]<li>Esto aumenta la duración total de la solicitud, lo que significa que las hebras (threads) de Liberty se retienen por más tiempo[cite: 96].</li>
                    [cite_start]<li>Una mayor ocupación de hebras aumenta la concurrencia y la probabilidad de <strong>saturación de zIIP</strong>[cite: 97].</li>
                    [cite_start]<li>La saturación de zIIP causa <strong>desbordamiento (spillover)</strong> a los CPs[cite: 98].</li>
                    [cite_start]<li>Este desbordamiento <strong>aumenta aún más la contención de CP</strong>, regresando al paso 1 con un retardo aún peor[cite: 99].</li>
                </ol>
                [cite_start]<p>Este ciclo puede llevar a una rápida degradación del servicio, agotamiento de la agrupación de hebras y fallos en cascada[cite: 86, 100].</p>
            </section>

            <section id="section-4">
                <h2>Sección 4: Marco de Medición y Análisis</h2>
                [cite_start]<p>Para diagnosticar estos problemas, es indispensable un enfoque de monitoreo de múltiples capas, correlacionando datos del sistema (RMF) con datos de la aplicación (SMF 123)[cite: 109, 367].</p>

                <h3>Capa 1: Análisis a Nivel de LPAR (RMF/SMF Tipo 70)</h3>
                [cite_start]<p>Este informe proporciona una visión de alto nivel de la salud general de los procesadores de la LPAR[cite: 121, 369].</p>
                <ul>
                    [cite_start]<li><strong>Informe Clave:</strong> Informe de Actividad de CPU de RMF (SMF Tipo 70, Subtipo 1)[cite: 122, 370].</li>
                    <li><strong>Métricas a Analizar:</strong>
                        <ul>
                            [cite_start]<li><code>LPAR Busy</code> vs. <code>MVS Busy</code>: Si LPAR Busy es significativamente mayor, indica contención a nivel de CEC (demanda latente)[cite: 372].</li>
                            [cite_start]<li><strong>Ocupación de CP y zIIP del LPAR:</strong> Buscar intervalos donde la ocupación de CP y zIIP sea consistentemente alta[cite: 123].</li>
                        </ul>
                    </li>
                </ul>

                <h3>Capa 2: Análisis Granular de Carga de Trabajo (RMF/SMF Tipo 72)</h3>
                [cite_start]<p>Este es el informe más crítico para entender la efectividad de la descarga a zIIP y medir la contención a nivel de la clase de servicio de z/OS Connect[cite: 378, 379].</p>
                <ul>
                    [cite_start]<li><strong>Informe Clave:</strong> Informe de Actividad de la Carga de Trabajo de RMF (WLMGL) (SMF Tipo 72, Subtipo 3)[cite: 110, 379].</li>
                    <li><strong>Métricas Clave a Analizar:</strong>
                        <table>
                            <thead>
                                <tr>
                                    <th>Métrica</th>
                                    <th>Campo SMF 72-3</th>
                                    <th>Descripción</th>
                                    <th>Qué Buscar (Interpretación)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><code>APPL% -> CP</code></td>
                                    <td>-</td>
                                    [cite_start]<td>Porcentaje de tiempo de CPU que se ejecutó en un CP estándar[cite: 383].</td>
                                    <td>Indica trabajo no elegible o desbordado.</td>
                                </tr>
                                <tr>
                                    <td><code>APPL% -> IIP</code></td>
                                    <td>-</td>
                                    [cite_start]<td>Porcentaje de tiempo de CPU que se ejecutó con éxito en un zIIP[cite: 383].</td>
                                    <td>Mide la descarga exitosa. Un valor alto es deseable.</td>
                                </tr>
                                <tr>
                                    <td><strong><code>APPL% -> IIPCP</code></strong></td>
                                    [cite_start]<td><code>R723SUCU</code> [cite: 166]</td>
                                    [cite_start]<td>Porcentaje de tiempo de CPU que era <strong>elegible para zIIP</strong> pero se vio forzado a ejecutarse en un CP[cite: 118, 383].</td>
                                    [cite_start]<td><strong>La métrica más importante para la saturación de zIIP</strong>[cite: 383]. [cite_start]Un valor creciente es un indicador principal de un cuello de botella de zIIP[cite: 384].</td>
                                </tr>
                                 <tr>
                                    <td><strong><code>CPU DLY %</code></strong></td>
                                    [cite_start]<td><code>R723CADL</code> [cite: 166]</td>
                                    [cite_start]<td>Porcentaje de tiempo que la carga de trabajo estuvo lista para ejecutarse pero estaba esperando un CP[cite: 115].</td>
                                    [cite_start]<td><strong>La medida directa del retardo de CP</strong>[cite: 116]. Causa raíz del aumento del tiempo de respuesta.</td>
                                </tr>
                                <tr>
                                    <td><code>VELOCITY</code></td>
                                    <td>-</td>
                                    [cite_start]<td>Indicador de si la carga de trabajo está cumpliendo sus objetivos de WLM[cite: 113].</td>
                                    [cite_start]<td>Una velocidad por debajo del objetivo indica que la carga de trabajo está siendo retrasada[cite: 114].</td>
                                </tr>
                            </tbody>
                        </table>
                    </li>
                </ul>

                <h3>Capa 3: Diagnóstico en Tiempo Real (RMF III / OMEGAMON)</h3>
                [cite_start]<p>Estas herramientas son cruciales para diagnosticar problemas activos e identificar los trabajos específicos que causan contención[cite: 139, 387].</p>
                <ul>
                    <li><strong>RMF Monitor III:</strong>
                        <ul>
                            [cite_start]<li><strong>Informe de Retrasos de Trabajos (Job Delays):</strong> Muestra qué espacios de direcciones están siendo retrasados[cite: 389]. [cite_start]Un valor alto en la columna <code>PRC</code> para z/OS Connect indica que está esperando un procesador[cite: 390].</li>
                            <li><strong>Informe de Retrasos del Procesador (Processor Delays):</strong> Desglosa el retraso <code>PRC</code>. Un <code>DELAY%</code> alto para zIIPs significa saturación de zIIP. [cite_start]Un <code>DELAY%</code> alto para CPs significa contención de CP[cite: 391, 392, 394].</li>
                        </ul>
                    </li>
                    <li><strong>OMEGAMON for JVM (o similar):</strong>
                        <ul>
                            [cite_start]<li><strong>Uso de CPU de JVM:</strong> Muestra el desglose en tiempo real entre tiempo de CP, tiempo de zIIP y, crucialmente, el trabajo elegible para zIIP que se ejecuta en CPs (el equivalente en tiempo real de <code>IIPCP</code>)[cite: 142, 143].</li>
                            [cite_start]<li><strong>Detalles de Hebras (Threads):</strong> Permite identificar hebras bloqueadas o de larga duración[cite: 144].</li>
                            [cite_start]<li><strong>Alertas (Situaciones):</strong> Se deben configurar alertas proactivas[cite: 153].
                                <ul>
                                    [cite_start]<li><strong>Advertencia:</strong> <code>% zIIP en CP</code> > 10% sostenido[cite: 155].</li>
                                    [cite_start]<li><strong>Crítico:</strong> <code>% zIIP en CP</code> > 50%[cite: 157].</li>
                                    [cite_start]<li><strong>Crítico:</strong> Tiempo de Respuesta Promedio > 2x la línea base[cite: 159].</li>
                                    [cite_start]<li><strong>Advertencia:</strong> Recuento de Hebras Activas > 80% del máximo[cite: 160].</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>

                <h3>Capa 4: Análisis de Solicitudes de Extremo a Extremo (SMF Tipo 123)</h3>
                [cite_start]<p>Este registro es generado por el propio z/OS Connect y es la fuente definitiva para el tiempo de respuesta de las solicitudes individuales[cite: 125, 396]. [cite_start]Es crucial habilitar los registros V2 (<code>apiRequesterSmfVersion="2"</code>) para flujos de Requester[cite: 126, 236].</p>
                <ul>
                    <li><strong>Metodología de Correlación:</strong>
                        <ol>
                            [cite_start]<li>Identificar períodos de alto Retardo de CP (<code>CPU DLY %</code>) o alto desbordamiento (<code>IIPCP %</code>) usando RMF (SMF 72)[cite: 135, 398].</li>
                            [cite_start]<li>Extraer los registros SMF 123 para el mismo intervalo de tiempo[cite: 135, 399].</li>
                            [cite_start]<li>Calcular los componentes del tiempo de respuesta usando las marcas de tiempo de SMF 123[cite: 400].</li>
                        </ol>
                    </li>
                    <li><strong>Cálculo de Tiempos (Ejemplo API Provider):</strong>
                        <table>
                            <thead>
                                <tr>
                                    <th>Marca de Tiempo (V2)</th>
                                    <th>Descripción</th>
                                    <th>Fórmula</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><code>TIME_ZC_ENTRY</code></td>
                                    [cite_start]<td>Llegada de la solicitud a z/OS Connect[cite: 404].</td>
                                    <td rowspan="4" style="vertical-align: middle;">
                                        [cite_start]<strong>Tiempo en SoR</strong> = <code>TIME_SOR_RECV</code> - <code>TIME_SOR_SENT</code> [cite: 404]<br><br>
                                        [cite_start]<strong>Tiempo total en z/OS Connect</strong> = <code>TIME_ZC_EXIT</code> - <code>TIME_ZC_ENTRY</code> [cite: 404]<br><br>
                                        [cite_start]<strong>Tiempo de procesamiento en z/OS Connect</strong> = (Tiempo total) - (Tiempo en SoR) [cite: 404]
                                    </td>
                                </tr>
                                <tr>
                                    <td><code>TIME_SOR_SENT</code></td>
                                    [cite_start]<td>Solicitud enviada al SoR[cite: 404].</td>
                                </tr>
                                <tr>
                                    <td><code>TIME_SOR_RECV</code></td>
                                    [cite_start]<td>Respuesta recibida del SoR[cite: 404].</td>
                                </tr>
                                <tr>
                                    <td><code>TIME_ZC_EXIT</code></td>
                                    [cite_start]<td>Respuesta enviada al cliente[cite: 404].</td>
                                </tr>
                            </tbody>
                        </table>
                    </li>
                    [cite_start]<li><strong>Conclusión de la Correlación:</strong> Si el <strong>"Tiempo de procesamiento en z/OS Connect"</strong> está elevado durante períodos de alto <code>CPU DLY %</code> o <code>IIPCP %</code>, se demuestra que la contención de CPU es la causa raíz de la degradación del rendimiento[cite: 137, 401].</li>
                </ul>
            </section>

            <section id="section-5">
                <h2>Sección 5: Estrategias Proactivas de Ajuste y Optimización</h2>
                [cite_start]<p>El diagnóstico debe ir seguido de acciones correctivas[cite: 168]. Estas estrategias ayudan a prevenir la contención y asegurar un rendimiento óptimo.</p>

                <h3>1. Configuración Estratégica de WLM</h3>
                [cite_start]<p>Una configuración adecuada de WLM es la primera línea de defensa[cite: 170, 408]. [cite_start]No se debe usar un objetivo discrecional para z/OS Connect[cite: 409, 630].</p>
                <ul>
                    [cite_start]<li><strong>Clasificación:</strong> Es fundamental habilitar <code>zosWlm-1.0</code> en <code>server.xml</code> y usar reglas de <code>httpClassification</code> para asignar la STC del servidor y los enclaves de solicitud (tipo CB) a clases de servicio separadas[cite: 178, 179, 180].</li>
                    [cite_start]<li><strong>Objetivos de Múltiples Períodos:</strong> Para las solicitudes (enclaves CB), el primer período debe tener un objetivo de velocidad alto (ej. Velocity 80%) con una duración corta[cite: 175]. [cite_start]Esto prioriza las solicitudes rápidas[cite: 176].</li>
                    [cite_start]<li><strong>Niveles de Importancia (Flujo Provider):</strong> Para un proveedor de API, el SoR de backend (ej. CICS) debe tener una importancia <strong>más alta</strong> que el servidor z/OS Connect[cite: 412]. [cite_start]Esto actúa como un estrangulamiento natural, protegiendo al componente más vulnerable[cite: 413].</li>
                    [cite_start]<li><strong>Niveles de Importancia (Flujo Requester):</strong> Para un solicitante de API, el servidor z/OS Connect debe tener una importancia <strong>más alta</strong> que la aplicación que lo llama[cite: 414].</li>
                    [cite_start]<li><strong>Parámetro <code>IIPHONORPRIORITY</code>:</strong> Este parámetro de LPAR (predeterminado YES) permite que el trabajo de zIIP desbordado compita por CPs según su prioridad de WLM[cite: 181, 182]. [cite_start]En entornos con escasez severa de CP, cambiarlo a NO es una opción de ajuste avanzada para preservar los CPs[cite: 185].</li>
                </ul>

                <h3>2. Ajuste del Subsistema z/OS y TCP/IP (Enfoque Requester)</h3>
                [cite_start]<p>Dado que los flujos de solicitante son intensivos en red, optimizar TCP/IP puede reducir significativamente el consumo de CP y la latencia[cite: 188].</p>
                <ul>
                    [cite_start]<li><strong>Habilitar AsyncIO:</strong> Habilitar el servicio nativo de z/OS AsyncIO permite a Liberty un manejo de sockets más eficiente, mejorando el rendimiento y la escalabilidad de las llamadas salientes[cite: 190, 191].</li>
                    <li><strong>Ajuste del Perfil de TCP/IP:</strong>
                        <ul>
                            [cite_start]<li><code>TCPCONFIG DELAYACKS</code>: Habilitar acuses de recibo retardados puede reducir la cantidad de paquetes y el consumo de CPU[cite: 193].</li>
                            [cite_start]<li><strong>Checksum Offload:</strong> Descargar los cálculos de suma de comprobación a las tarjetas de red OSA-Express reduce la carga en los CPs[cite: 194].</li>
                            [cite_start]<li><strong>Tamaños de Búfer:</strong> Asegurar tamaños adecuados (ej. >= 64KB) para <code>DefaultSendBufferSize</code> y <code>DefaultReceiveBufferSize</code> optimiza el rendimiento de la red[cite: 195].</li>
                        </ul>
                    </li>
                </ul>

                <h3>3. Optimización a Nivel de Aplicación (Reducción de Payloads)</h3>
                [cite_start]<p>Reducir la demanda de CPU en la fuente es la forma más eficiente de optimización[cite: 429]. [cite_start]El costo de CPU es directamente proporcional al tamaño del payload JSON que debe ser transformado[cite: 34, 430].</p>
                <ul>
                    [cite_start]<li><strong>Excluir Campos No Utilizados:</strong> Trabajar con los desarrolladores para mapear solo los campos absolutamente necesarios[cite: 431]. [cite_start]Excluir campos no utilizados reduce drásticamente el tamaño del payload y el consumo de CPU[cite: 432].</li>
                    [cite_start]<li><strong>Usar <code>OCCURS DEPENDING ON</code> (ODO):</strong> Para arrays de COBOL, usar ODO en lugar de arrays de tamaño fijo permite payloads de tamaño variable, reduciendo la sobrecarga de transformación[cite: 433].</li>
                    [cite_start]<li><strong>Renombrar Campos:</strong> Usar nombres de campo más cortos en el esquema JSON reduce los datos a analizar[cite: 434].</li>
                </ul>

                <h3>4. Planificación Proactiva de la Capacidad</h3>
                [cite_start]<p>La planificación de capacidad es fundamental y no debe basarse en promedios, sino en volúmenes máximos, ya que las cargas de trabajo de zIIP suelen ser "puntiagudas"[cite: 197, 422, 423]. [cite_start]El objetivo debe ser mantener el valor de <code>IIPCP</code> cerca de cero durante los picos de negocio[cite: 424].</p>
                [cite_start]<p>Las métricas <code>% CPU DLY</code> y <code>% IIPCP</code> deben guiar la toma de decisiones[cite: 209]:</p>
                <ul>
                    <li><strong><code>% CPU DLY</code> alto, <code>% IIPCP</code> bajo:</strong> Cuello de botella clásico de CP. [cite_start]La solución es añadir CPs[cite: 210, 211].</li>
                    <li><strong><code>% CPU DLY</code> bajo, <code>% IIPCP</code> alto:</strong> Cuello de botella clásico de zIIP. [cite_start]La solución es añadir zIIPs[cite: 212].</li>
                    <li><strong><code>% CPU DLY</code> alto, <code>% IIPCP</code> alto:</strong> El sistema está completamente saturado. [cite_start]Se requiere la adición de ambos, CPs y zIIPs[cite: 213, 214].</li>
                    [cite_start]<li><strong><code>% CPU DLY</code> bajo, <code>% IIPCP</code> bajo:</strong> El problema de rendimiento no está relacionado con la contención de procesadores en z/OS[cite: 215]. [cite_start]La investigación debe centrarse en la latencia de la red o el rendimiento del endpoint remoto[cite: 216].</li>
                </ul>
                [cite_start]<p>Un valor de <code>% IIPCP</code> del 100% significa que un CP completo se está utilizando para trabajo de zIIP[cite: 120, 203]. [cite_start]Esto se puede traducir directamente en un impacto de costo de MLC, proporcionando una justificación financiera para adquirir motores zIIP adicionales[cite: 204].</p>
            </section>

            <section id="section-6">
                <h2>Sección 6: Conclusión y Resumen de Hallazgos</h2>
                [cite_start]<p>El rendimiento de z/OS Connect está intrínsecamente ligado a la gestión eficaz de los procesadores CP y zIIP[cite: 219, 436]. [cite_start]La arquitectura ofrece un enorme potencial para procesar cargas de trabajo de modernización de manera rentable[cite: 437]. [cite_start]Sin embargo, este modelo introduce un riesgo crítico: la saturación de los procesadores zIIP y la contención de los CPs[cite: 221, 438].</p>
                [cite_start]<p>El análisis ha demostrado que la carga de trabajo de z/OS Connect es una amalgama de tareas vinculadas a CP (E/S de red, seguridad) y tareas elegibles para zIIP (transformación JSON)[cite: 222]. [cite_start]La escasez en cualquiera de los procesadores crea un efecto dominó[cite: 224, 440]:</p>
                <ul>
                    [cite_start]<li>La <strong>escasez de CP</strong> retrasa las tareas de red y seguridad, aumentando el tiempo total de la solicitud[cite: 95].</li>
                    [cite_start]<li>Esto aumenta la concurrencia, lo que lleva a la <strong>saturación de zIIP</strong>[cite: 97].</li>
                    [cite_start]<li>La saturación de zIIP causa un <strong>desbordamiento (spillover)</strong> de trabajo Java hacia los CPs[cite: 98].</li>
                    [cite_start]<li>Este desbordamiento <strong>exacerba la contención de CP</strong>, degradando el rendimiento de todo el sistema y aumentando los costos de licenciamiento[cite: 225, 441].</li>
                </ul>
                [cite_start]<p>La clave del éxito reside en una gestión proactiva y basada en datos[cite: 226, 442]. [cite_start]Es imperativo implementar un marco de monitoreo que correlacione los datos de RMF (SMF 70 y 72) con los registros de aplicación (SMF 123)[cite: 227, 443]. [cite_start]La métrica <code>IIPCP</code> (o <code>% zIIP en CP</code>) emerge como el indicador principal más crucial de la inminente saturación de zIIP[cite: 228, 444].</p>
            </section>

            <section id="section-7">
                <h2>Sección 7: Lista de Verificación Accionable</h2>
                [cite_start]<p>Utilice esta lista de verificación como guía estratégica para la gestión proactiva del rendimiento de z/OS Connect[cite: 230].</p>
                
                <div class="checklist-container">
                    
                    <div class="checklist-category-card">
                        <h3><span class="icon">🔍</span> VALIDAR: Configuración de WLM</h3>
                        <ul class="checklist">
                            [cite_start]<li><label><input type="checkbox"> Confirmar que <code>zosWlm-1.0</code> está activa en server.xml[cite: 232].</label></li>
                            [cite_start]<li><label><input type="checkbox"> Asegurar que existan reglas de <code>httpClassification</code> para las cargas de trabajo (ej. <code>/zosConnect/apiRequesters/*</code>)[cite: 233].</label></li>
                            [cite_start]<li><label><input type="checkbox"> Verificar que la política de WLM clasifica correctamente la STC y los enclaves (CB) en clases de servicio apropiadas (usar objetivos de velocidad)[cite: 234].</label></li>
                            [cite_start]<li><label><input type="checkbox"> Verificar que la importancia del SoR (CICS/IMS) es <strong>mayor</strong> que la de z/OS Connect (para flujos de Provider)[cite: 412].</label></li>
                        </ul>
                    </div>
            
                    <div class="checklist-category-card">
                        <h3><span class="icon">📏</span> MEDIR: Establecer Líneas Base</h3>
                        <ul class="checklist">
                            [cite_start]<li><label><input type="checkbox"> Habilitar registros SMF 123 (V2 para Requester: <code>apiRequesterSmfVersion="2"</code>)[cite: 236].</label></li>
                            [cite_start]<li><label><input type="checkbox"> Recopilar y archivar regularmente datos de RMF (SMF 70, 72) y SMF 123[cite: 237].</label></li>
                            [cite_start]<li><label><input type="checkbox"> Establecer líneas base para <code>Tiempo en z/OS Connect</code>, <code>% CPU DLY</code> y <code>% IIPCP</code> durante picos[cite: 238].</label></li>
                        </ul>
                    </div>
                    
                    <div class="checklist-category-card">
                        <h3><span class="icon">🖥️</span> MONITORIZAR: Alertas en Tiempo Real</h3>
                        <ul class="checklist">
                            [cite_start]<li><label><input type="checkbox"> Utilizar un monitor en tiempo real (RMF III, OMEGAMON for JVM)[cite: 240].</label></li>
                            [cite_start]<li><label><input type="checkbox"> Configurar alertas para <code>% zIIP en CP</code> (Advertencia > 10%, Crítico > 50%)[cite: 242].</label></li>
                            [cite_start]<li><label><input type="checkbox"> Configurar alertas para Tiempo de Respuesta (Crítico > 2x la línea base)[cite: 243].</label></li>
                            [cite_start]<li><label><input type="checkbox"> Configurar alertas para Recuento de Hebras Activas (Advertencia > 80% del máximo)[cite: 244].</label></li>
                        </ul>
                    </div>
            
                    <div class="checklist-category-card">
                        <h3><span class="icon">🩺</span> DIAGNOSTICAR: Analizar Anomalías</h3>
                        <ul class="checklist">
                            [cite_start]<li><label><input type="checkbox"> Correlacionar <code>Tiempo en z/OS Connect</code> (SMF 123) con <code>% CPU DLY</code> y <code>% IIPCP</code> (RMF 72)[cite: 247].</label></li>
                            [cite_start]<li><label><input type="checkbox"> Usar la "Matriz de Contención" (Sección 5) para identificar el cuello de botella (CP, zIIP, ambos)[cite: 248].</label></li>
                        </ul>
                    </div>
            
                    <div class="checklist-category-card">
                        <h3><span class="icon">🛠️</span> AJUSTAR: Optimizar el Entorno</h3>
                        <ul class="checklist">
                            [cite_start]<li><label><input type="checkbox"> Revisar y optimizar la política de WLM (ver "VALIDAR")[cite: 250].</label></li>
                            [cite_start]<li><label><input type="checkbox"> (Para Requester) Habilitar <code>AsyncIO</code> para Liberty[cite: 251].</label></li>
                            [cite_start]<li><label><input type="checkbox"> (Para Requester) Revisar parámetros de TCP/IP (<code>DELAYACKS</code>, Búferes)[cite: 252].</label></li>
                            [cite_start]<li><label><input type="checkbox"> (Para Provider) Optimizar payloads de API (excluir campos, usar ODO)[cite: 431, 433].</label></li>
                        </ul>
                    </div>
            
                    <div class="checklist-category-card">
                        <h3><span class="icon">📈</span> PLANIFICAR: Impulsar la Capacidad</h3>
                        <ul class="checklist">
                            [cite_start]<li><label><input type="checkbox"> Usar tendencias históricas de <code>% IIPCP</code> para pronosticar necesidades de zIIP[cite: 254].</label></li>
                            [cite_start]<li><label><input type="checkbox"> Usar tendencias de <code>% CPU DLY</code> para evaluar la capacidad de CP[cite: 255].</label></li>
                            [cite_start]<li><label><input type="checkbox"> Traducir <code>% IIPCP</code> en impacto de costo de MLC para justificar la adquisición de hardware[cite: 256].</label></li>
                        </ul>
                    </div>
            
                </div>
            </section>

        </main>
    </div>

    <footer>
        <p>Este documento es una síntesis de los materiales proporcionados sobre el rendimiento de z/OS Connect. El contenido se basa en la información de los documentos originales.</p>
    </footer>

</body>
</html>
